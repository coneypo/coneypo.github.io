<!DOCTYPE html>
<html>
<head>
	<link href="style_content.css" rel="stylesheet" type="text/css">
</head>

<body>
<script>
setTimeout(function(){var rellax = new Rellax('.rellax')},50);

window.addEventListener('scroll', function(){
  document.querySelector('.img').style.opacity = (1 - window.scrollY / (window.innerHeight * 0.75)) * 0.5;
  document.querySelector('.img img').style.filter = `blur(${(window.scrollY / (window.innerHeight * 0.75)) * 5}px)`;
});
</script>

<section class="hero">
  <div>
    <div class="img">
      <img class="rellax" data-rellax-speed="-5" src="https://images2017.cnblogs.com/blog/1152352/201801/1152352-20180124074534912-1357533271.png" alt="cherry blossoms" title="cherry blossoms">
    </div>
    <h2>Python 3 利用 Dlib 实现人脸检测和剪切</h2>
    <em><b class="meta"><i></i> Author : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; coneypo</b><br>
    <b class="meta"><i>Created at :&nbsp;&nbsp;&nbsp;Jan 24, 2018</i> </b><br>
	<b class="meta"><i>Updated at :&nbsp;&nbsp;Sep 27, 2018</i> </b>
	</em>
  </div>
</section>

<main>
<p><strong><span style="font-size: 18px;">0.引言</span><br /></strong></p>
<p>　　　利用 Python 开发，借助 Dlib 库进行人脸检测 / face detection；</p>
<p>　　　<strong>1.</strong>&nbsp;<strong><a id="840b1e4adc2ca0d93ef60f54c7e2b1cc-ca73c1b5eb805b25f59a450e3718eec671866d5c" class="js-navigation-open" title="crop_faces_show.py" href="https://github.com/coneypo/Dlib_face_cut/blob/master/crop_faces_show.py">crop_faces_show.py</a>&nbsp;:</strong><span style="text-decoration: underline;"><strong><span style="font-size: 16px;"><br /></span></strong></span></p>
<p>　　　　将检测到的人脸剪切下来，依次排序平铺显示在新的图像上；</p>
<p>　　　　实现的效果如图1所示，将图1原图中的6张人脸检测出来，然后剪切下来，在图像窗口中依次输出显示人脸；</p>
<p>　　　<strong>2.&nbsp;<strong><a id="0b4249af0ff9241a5a3159de48a7142d-35a784cc8f0aaa493420209ab9774a8674cd1cef" class="js-navigation-open" title="crop_faces_save.py" href="https://github.com/coneypo/Dlib_face_cut/blob/master/crop_faces_save.py">crop_faces_save.py</a>&nbsp;</strong>:</strong></p>
<p><em>　　　</em>　将检测到的人脸生成单个 image，存储到本地路径；</p>
<p>&nbsp;</p>
<center>
<p>&nbsp;　　<img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180124074534912-1357533271.png" alt="" width="698" height="634" /></p>
<p><strong>图 1 原图和&nbsp;crop_faces_show.py&nbsp;处理后得到的平铺人脸图像窗口</strong></p>







</center>
<p>&nbsp;</p>
<center>
<p><strong>　　<img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180125140506115-2142846280.png" alt="" /></strong></p>
<p><strong>图 2 crop_faces_save.py<strong><strong><strong>&nbsp;</strong></strong></strong>处理后得到的多个单张人脸图像文件</strong></p>







</center>
<p>&nbsp;</p>
<p><strong>　　源码上传到了我的 Github;</strong></p>
<p><strong>　　如果对您有帮助或者感兴趣，欢迎 Star 支持下:&nbsp;<a title="Dlib_face_cut" href="https://github.com/coneypo/Dlib_face_cut" target="_blank">https://github.com/coneypo/Dlib_face_cut</a></strong></p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>1.</strong><strong>开发环境</strong></span></p>
<p>　　Python:　　3.6.3</p>
<p>　　Dlib:　　　 19.7</p>
<p>　　OpenCv, NumPy</p>
<div class="cnblogs_code" style="margin-left: 30px;">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">import</span> dlib         <span style="color: #008000;">#</span><span style="color: #008000;"> 人脸识别的库dlib</span>
<span style="color: #008080;">2</span> <span style="color: #0000ff;">import</span> numpy as np  <span style="color: #008000;">#</span><span style="color: #008000;"> 数据处理的库numpy</span>
<span style="color: #008080;">3</span> <span style="color: #0000ff;">import</span> cv2          <span style="color: #008000;">#</span><span style="color: #008000;"> 图像处理的库OpenCv</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>2.设计流程</strong></span></p>
<p><strong>　　</strong>工作内容主要以下两大块<strong>：Dlib 人脸检测 和 绘制新图像</strong></p>
<p><strong>　　2.1 Dlib 人脸检测</strong></p>
<p>　　　　Dlib 的使用，在我之前另一篇博客里面介绍过</p>
<p>　　　　( link:&nbsp;<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/AdaminXie/p/7905888.html">Python 3 利用 Dlib 19.7 进行人脸检测</a>）；</p>
<div class="cnblogs_code" style="margin-left: 30px;">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib 检测器</span>
<span style="color: #008080;"> 2</span> detector =<span style="color: #000000;"> dlib.get_frontal_face_detector()
</span><span style="color: #008080;"> 3</span> predictor = dlib.shape_predictor(<span style="color: #800000;">'</span><span style="color: #800000;">shape_predictor_68_face_landmarks.dat</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 读取图像</span>
<span style="color: #008080;"> 6</span> path = <span style="color: #800000;">"</span><span style="color: #800000;">/***/image_path/</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 7</span> img = cv2.imread(path+<span style="color: #800000;">"</span><span style="color: #800000;">test_faces.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 8</span> <span style="color: #008000;">#</span><span style="color: #008000;">print("img/shape:", img.shape)</span>
<span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib 检测</span>
<span style="color: #008080;">11</span> faces = detector(img, 1<span style="color: #000000;">)
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">人脸数：</span><span style="color: #800000;">"</span>, len(faces))</pre>
</div>
<p>　　　　&nbsp;接下来需要得到人脸的坐标，用来计算人脸矩形的高度和宽度。</p>
<p>&nbsp;</p>
<p>　　<strong>2.2&nbsp;绘制新图像</strong></p>
<p>　　　　&nbsp;如果你想让人脸并排显示的话，稍微麻烦一点，需要遍历两次 faces（for k, d in enumerate (faces)）:</p>
<p>　　&nbsp;<strong>第一次遍历：</strong>记录下我们需要生成的图像窗口的大小，因为需要将多张照片显示在一张图像上，所以需要知道每张人脸照片的大小；</p>
<p><strong>　　 第二次遍历：</strong>根据之前得到的图像尺寸新建空白图像，然后开始用人脸矩形填充图像；</p>
<p>&nbsp;</p>
<p>　　2.2.1 确定空白图像尺寸</p>
<p style="margin-left: 30px;">　　（这部分首先要根据检测到的人脸数和人脸大小，来确定绘制图像所需要的尺寸）　　</p>
<p style="margin-left: 30px;"><strong>第一次遍历：</strong>多张人脸要输出到一行，所以先进行一次人脸的遍历j记下每张人脸的大小，记每张人脸的尺寸为&nbsp;<span style="font-size: 16px;"><strong>高度 height&nbsp; *宽度 width</strong></span>（高度和宽度说明见图3）：</p>
<center>
<p><img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180129153820484-2828104.png" alt="" width="683" height="429" /></p>
<p><strong>图 3 图像尺寸说明</strong></p>
</center>
<p>&nbsp;</p>
<p style="margin-left: 30px;">我取的生成空白图像的尺寸：<strong>height_max（最大高度）和width_sum（宽度之和）</strong>，然后根据尺寸大小来新建空白图像：</p>
<div class="cnblogs_code" style="margin-left: 30px;">
<pre><span style="color: #008080;">1</span> img_blank = np.zeros((height_max, width_sum, 3), np.uint8)</pre>
</div>
<center>
<p><img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180129172805296-899059000.png" alt="" width="712" height="212" /></p>
<p><strong>图 4 图像尺寸 height_max 和 width_sum</strong></p>
</center>
<p>&nbsp;</p>
<p>　　2.2.2 图像填充</p>
<p><strong>　　第二次遍历：</strong>多根据之前得到的图像尺寸新建空白图像，然后开始用人脸矩形填充图像，每次 width 方向从 blank_start 位置开始，每次填完一张之后记得更新起始位置：（blank_start += width）：</p>
<div class="cnblogs_code" style="margin-left: 30px;">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(height):
</span><span style="color: #008080;">2</span>     <span style="color: #0000ff;">for</span> j <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(width):
</span><span style="color: #008080;">3</span>         img_blank[i][blank_start + j] = img[d.top() + i][d.left() + j]</pre>
</div>
<p style="margin-left: 30px;">　　<strong>　　</strong></p>
<p><strong>　　如果想访问图像的某点像素，可以利用 img[height][width]：</strong></p>
<p><strong>　　　　存储像素其实是一个三维数组，先高度 height，然后宽度 width;</strong></p>
<p><strong>　　　　返回的是一个颜色数组（<span style="color: #00ffff;">0-255</span>，<strong><span style="color: #00ff00;">0-255</span>，</strong><span style="color: #ff0000;"><strong>0-255</strong></span>），按照（<span style="color: #00ffff;">B</span>, <span style="color: #00ff00;">G</span>, <span style="color: #ff0000;">R</span>）的顺序；</strong></p>
<p><strong>　　　　比如&nbsp;<span style="background-color: #00ffff;">蓝色<span style="background-color: #ffffff;">&nbsp;</span></span>就是（255，0，0），<span style="background-color: #ff0000;">红色<span style="background-color: #ffffff;">&nbsp;</span></span>是（0，0，255）;</strong></p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>3.源码</strong></span></p>
<p><span style="font-size: 18px;"><strong>3.1&nbsp;crop_faces_show.py</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;"> created at 2018-01-22</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">#</span><span style="color: #008000;"> updated at 2018-09-06</span>
<span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Author:   coneypo</span>
<span style="color: #008080;"> 5</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Blog:     http://www.cnblogs.com/AdaminXie</span>
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> GitHub:   https://github.com/coneypo/Dlib_face_cut</span>
<span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> dlib         <span style="color: #008000;">#</span><span style="color: #008000;"> 人脸识别的库dlib</span>
<span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> numpy as np  <span style="color: #008000;">#</span><span style="color: #008000;"> 数据处理的库numpy</span>
<span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> cv2          <span style="color: #008000;">#</span><span style="color: #008000;"> 图像处理的库OpenCv</span>
<span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib 预测器</span>
<span style="color: #008080;">13</span> detector =<span style="color: #000000;"> dlib.get_frontal_face_detector()
</span><span style="color: #008080;">14</span> predictor = dlib.shape_predictor(<span style="color: #800000;">'</span><span style="color: #800000;">shape_predictor_68_face_landmarks.dat</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 读取图像</span>
<span style="color: #008080;">17</span> path = <span style="color: #800000;">"</span><span style="color: #800000;">images/</span><span style="color: #800000;">"</span>
<span style="color: #008080;">18</span> img = cv2.imread(path+<span style="color: #800000;">"</span><span style="color: #800000;">test_faces_5.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib检测</span>
<span style="color: #008080;">21</span> dets = detector(img, 1<span style="color: #000000;">)
</span><span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span> <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">人脸数：</span><span style="color: #800000;">"</span><span style="color: #000000;">, len(dets))
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 记录人脸矩阵大小</span>
<span style="color: #008080;">26</span> height_max =<span style="color: #000000;"> 0
</span><span style="color: #008080;">27</span> width_sum =<span style="color: #000000;"> 0
</span><span style="color: #008080;">28</span> 
<span style="color: #008080;">29</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 计算要生成的图像 img_blank 大小</span>
<span style="color: #008080;">30</span> <span style="color: #0000ff;">for</span> k, d <span style="color: #0000ff;">in</span><span style="color: #000000;"> enumerate(dets):
</span><span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 计算矩形大小</span>
<span style="color: #008080;">33</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> (x,y), (宽度width, 高度height)</span>
<span style="color: #008080;">34</span>     pos_start =<span style="color: #000000;"> tuple([d.left(), d.top()])
</span><span style="color: #008080;">35</span>     pos_end =<span style="color: #000000;"> tuple([d.right(), d.bottom()])
</span><span style="color: #008080;">36</span> 
<span style="color: #008080;">37</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 计算矩形框大小</span>
<span style="color: #008080;">38</span>     height = d.bottom()-<span style="color: #000000;">d.top()
</span><span style="color: #008080;">39</span>     width = d.right()-<span style="color: #000000;">d.left()
</span><span style="color: #008080;">40</span> 
<span style="color: #008080;">41</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 处理宽度</span>
<span style="color: #008080;">42</span>     width_sum +=<span style="color: #000000;"> width
</span><span style="color: #008080;">43</span> 
<span style="color: #008080;">44</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 处理高度</span>
<span style="color: #008080;">45</span>     <span style="color: #0000ff;">if</span> height &gt;<span style="color: #000000;"> height_max:
</span><span style="color: #008080;">46</span>         height_max =<span style="color: #000000;"> height
</span><span style="color: #008080;">47</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">48</span>         height_max =<span style="color: #000000;"> height_max
</span><span style="color: #008080;">49</span> 
<span style="color: #008080;">50</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 绘制用来显示人脸的图像的大小</span>
<span style="color: #008080;">51</span> <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">img_blank的大小：</span><span style="color: #800000;">"</span>
<span style="color: #008080;">52</span>       , <span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">"</span><span style="color: #800000;">高度 / height:</span><span style="color: #800000;">"</span><span style="color: #000000;">, height_max
</span><span style="color: #008080;">53</span>       , <span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">"</span><span style="color: #800000;">宽度 / width:</span><span style="color: #800000;">"</span><span style="color: #000000;">, width_sum)
</span><span style="color: #008080;">54</span> 
<span style="color: #008080;">55</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 生成用来显示的图像</span>
<span style="color: #008080;">56</span> img_blank = np.zeros((height_max, width_sum, 3<span style="color: #000000;">), np.uint8)
</span><span style="color: #008080;">57</span> 
<span style="color: #008080;">58</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 记录每次开始写入人脸像素的宽度位置</span>
<span style="color: #008080;">59</span> blank_start =<span style="color: #000000;"> 0
</span><span style="color: #008080;">60</span> 
<span style="color: #008080;">61</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 将人脸填充到img_blank</span>
<span style="color: #008080;">62</span> <span style="color: #0000ff;">for</span> k, d <span style="color: #0000ff;">in</span><span style="color: #000000;"> enumerate(dets):
</span><span style="color: #008080;">63</span> 
<span style="color: #008080;">64</span>     height = d.bottom()-<span style="color: #000000;">d.top()
</span><span style="color: #008080;">65</span>     width = d.right()-<span style="color: #000000;">d.left()
</span><span style="color: #008080;">66</span> 
<span style="color: #008080;">67</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 填充</span>
<span style="color: #008080;">68</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(height):
</span><span style="color: #008080;">69</span>         <span style="color: #0000ff;">for</span> j <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(width):
</span><span style="color: #008080;">70</span>                 img_blank[i][blank_start+j] = img[d.top()+i][d.left()+<span style="color: #000000;">j]
</span><span style="color: #008080;">71</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 调整图像</span>
<span style="color: #008080;">72</span>     blank_start +=<span style="color: #000000;"> width
</span><span style="color: #008080;">73</span> 
<span style="color: #008080;">74</span> cv2.namedWindow(<span style="color: #800000;">"</span><span style="color: #800000;">img_faces</span><span style="color: #800000;">"</span>)<span style="color: #008000;">#</span><span style="color: #008000;">, 2)</span>
<span style="color: #008080;">75</span> cv2.imshow(<span style="color: #800000;">"</span><span style="color: #800000;">img_faces</span><span style="color: #800000;">"</span><span style="color: #000000;">, img_blank)
</span><span style="color: #008080;">76</span> cv2.waitKey(0)</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>结果：</strong></p>
<center>
<p>&nbsp;<img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180124084309194-88289299.png" alt="" width="724" height="727" /></p>
<p><strong>图 5 原图和处理后得到的图像窗口</strong></p>
</center>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong><strong>3.2 crop_faces_show.py</strong></strong></span></p>
<p>　　如果你想将识别出来的人脸保存成单个的 jpg，方便之后处理用，只需将上述代码进行略微修改；</p>
<p>　　只需一次遍历，根据每次检测到的人脸尺寸，新建空白图像后写入，然后利用 cv2.imwrite 写入到本地：</p>
<p><strong>　　crop_faces_show.py:</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;"> created at 2018-01-22</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">#</span><span style="color: #008000;"> updated at 2018-09-06</span>
<span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Author:   coneypo</span>
<span style="color: #008080;"> 5</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Blog:     http://www.cnblogs.com/AdaminXie</span>
<span style="color: #008080;"> 6</span> <span style="color: #008000;">#</span><span style="color: #008000;"> GitHub:   https://github.com/coneypo/Dlib_face_cut</span>
<span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> dlib         <span style="color: #008000;">#</span><span style="color: #008000;"> 人脸识别的库dlib</span>
<span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> numpy as np  <span style="color: #008000;">#</span><span style="color: #008000;"> 数据处理的库numpy</span>
<span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> cv2          <span style="color: #008000;">#</span><span style="color: #008000;"> 图像处理的库OpenCv</span>
<span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib 预测器</span>
<span style="color: #008080;">13</span> detector =<span style="color: #000000;"> dlib.get_frontal_face_detector()
</span><span style="color: #008080;">14</span> predictor = dlib.shape_predictor(<span style="color: #800000;">'</span><span style="color: #800000;">shape_predictor_68_face_landmarks.dat</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 读取图像的路径</span>
<span style="color: #008080;">17</span> path_read = <span style="color: #800000;">"</span><span style="color: #800000;">images/</span><span style="color: #800000;">"</span>
<span style="color: #008080;">18</span> img = cv2.imread(path_read+<span style="color: #800000;">"</span><span style="color: #800000;">test_faces_1.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span> <span style="color: #008000;">#</span><span style="color: #008000;"> 用来存储生成的单张人脸的路径</span>
<span style="color: #008080;">21</span> path_save = <span style="color: #800000;">"</span><span style="color: #800000;">crop_faces_save_folder/</span><span style="color: #800000;">"</span>
<span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Dlib 检测</span>
<span style="color: #008080;">24</span> faces = detector(img, 1<span style="color: #000000;">)
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span> <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">人脸数：</span><span style="color: #800000;">"</span><span style="color: #000000;">, len(faces))
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span> <span style="color: #0000ff;">for</span> k, d <span style="color: #0000ff;">in</span><span style="color: #000000;"> enumerate(faces):
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 计算矩形大小</span>
<span style="color: #008080;">31</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> (x,y), (宽度width, 高度height)</span>
<span style="color: #008080;">32</span>     pos_start =<span style="color: #000000;"> tuple([d.left(), d.top()])
</span><span style="color: #008080;">33</span>     pos_end =<span style="color: #000000;"> tuple([d.right(), d.bottom()])
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 计算矩形框大小</span>
<span style="color: #008080;">36</span>     height = d.bottom()-<span style="color: #000000;">d.top()
</span><span style="color: #008080;">37</span>     width = d.right()-<span style="color: #000000;">d.left()
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 根据人脸大小生成空的图像</span>
<span style="color: #008080;">40</span>     img_blank = np.zeros((height, width, 3<span style="color: #000000;">), np.uint8)
</span><span style="color: #008080;">41</span> 
<span style="color: #008080;">42</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(height):
</span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">for</span> j <span style="color: #0000ff;">in</span><span style="color: #000000;"> range(width):
</span><span style="color: #008080;">44</span>                 img_blank[i][j] = img[d.top()+i][d.left()+<span style="color: #000000;">j]
</span><span style="color: #008080;">45</span> 
<span style="color: #008080;">46</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> cv2.imshow("face_"+str(k+1), img_blank)</span>
<span style="color: #008080;">47</span> 
<span style="color: #008080;">48</span>     <span style="color: #008000;">#</span><span style="color: #008000;"> 存在本地</span>
<span style="color: #008080;">49</span>     <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">Save to:</span><span style="color: #800000;">"</span>, path_save+<span style="color: #800000;">"</span><span style="color: #800000;">img_face_</span><span style="color: #800000;">"</span>+str(k+1)+<span style="color: #800000;">"</span><span style="color: #800000;">.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">50</span>     cv2.imwrite(path_save+<span style="color: #800000;">"</span><span style="color: #800000;">img_face_</span><span style="color: #800000;">"</span>+str(k+1)+<span style="color: #800000;">"</span><span style="color: #800000;">.jpg</span><span style="color: #800000;">"</span>, img_blank)</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
<p>　　<img src="http://images2017.cnblogs.com/blog/1152352/201801/1152352-20180124211419694-701586329.png" alt="" /></p>
<p><strong>图 6 生成的单个人脸 jpg</strong></p>
</center>
<p>&nbsp;</p>
<p><strong><strong><strong><strong><strong># 请尊重他人劳动成果，转载或者使用源码请注明出处：</strong><a title="xie" href="http://www.cnblogs.com/AdaminXie/" target="_blank">http://www.cnblogs.com/AdaminXie</a></strong></strong></strong></strong></p>
<p><strong>#</strong> <strong>如果对您有帮助，欢迎在 GitHub 上 Star 本项目:&nbsp;<a title="Dlib_face_cut" href="https://github.com/coneypo/Dlib_face_cut" target="_blank">https://github.com/coneypo/Dlib_face_cut</a></strong></p>
<p><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong># 如有问题请留言或者联系邮箱&nbsp;<a href="mailto:coneypo@foxmail.com">coneypo@foxmail.com</a></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p>
<p>&nbsp;</p>

</main>
</body>
</html>
</html>